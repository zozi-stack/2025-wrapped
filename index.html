<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My 2025 Wrapped — The Year of the Snake</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=David+Libre:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Shadow Overlay -->
  <div class="shadow-overlay">
    <img src="images/Textures/ShadowHorizontal.png" alt="" class="shadow-img">
  </div>

  <!-- Background -->
  <div class="bg"></div>

  <!-- Main Content -->
  <main class="main-container">
    <!-- Header -->
    <header class="header">
      <h1 class="title">My <em>2025</em> Wrapped</h1>
      <div class="subtitle-row">
        <p class="subtitle">(The Year of the <span class="snake">Snake</span>)</p>
        <p class="author">Zoe 郑</p>
      </div>
    </header>

    <!-- Content Area - TOC + Stack side by side -->
    <div class="content-area">
      <!-- Table of Contents -->
      <nav class="toc">
        <ul class="toc-list">
          <li class="toc-item" data-section="sketches">No. 1. Sketches</li>
          <li class="toc-item" data-section="dates">No. 2. Dates</li>
          <li class="toc-item" data-section="books">No. 3. Books</li>
          <li class="toc-item" data-section="piano">No. 4. Piano</li>
          <li class="toc-item" data-section="lessons">No. 5. Lessons</li>
          <li class="toc-item" data-section="questions">No. 6. Questions</li>
          <li class="toc-item" data-section="2026">No. 7. 2026</li>
        </ul>
      </nav>

      <!-- Paper Stack -->
      <div class="paper-stack" id="paper-stack">
        <!-- 2026 Symbol - Bottom/not swipable -->
        <div class="paper paper-2026" data-section="2026">
          <img src="images/2026 Symbol.png" alt="2026">
        </div>

        <!-- Birthday Polaroids -->
        <div class="paper paper-birthday swipable" data-section="questions">
          <img src="images/BirthdayPolaroids.png" alt="Birthday Polaroids">
        </div>

        <!-- Reflective Writing -->
        <div class="paper paper-reflective swipable" data-section="questions">
          <img src="images/ReflectiveWriting.png" alt="Reflective Writing">
        </div>

        <!-- Questions -->
        <div class="paper paper-questions swipable" data-section="questions">
          <img src="images/Questions.png" alt="Questions">
        </div>

        <!-- Lessons - now above questions -->
        <div class="paper paper-lessons swipable" data-section="lessons">
          <img src="images/Lessons.png" alt="Lessons">
        </div>

        <!-- Piano - Fly -->
        <div class="paper paper-piano-fly swipable" data-section="piano">
          <img src="images/piano/Fly.png" alt="Fly">
        </div>

        <!-- Piano - Etude 6 -->
        <div class="paper paper-piano-etude6 swipable" data-section="piano">
          <img src="images/piano/GlassEtudeNo.6.png" alt="Glass Etude No. 6">
        </div>

        <!-- Piano - Etude 1 -->
        <div class="paper paper-piano-etude1 swipable" data-section="piano">
          <img src="images/piano/GlassEtudeNo.1.png" alt="Glass Etude No. 1">
        </div>

        <!-- Piano - Sonata -->
        <div class="paper paper-piano-sonata swipable" data-section="piano">
          <img src="images/piano/Sonata.png" alt="Sonata">
        </div>

        <!-- Books -->
        <div class="paper paper-books swipable" data-section="books">
          <img src="images/Books.png" alt="Books">
        </div>

        <!-- Dates -->
        <div class="paper paper-dates swipable" data-section="dates">
          <img src="images/Dates.png" alt="Dates">
        </div>

        <!-- April Sketch - Top layer -->
        <div class="paper paper-april swipable" data-section="sketches">
          <img src="images/sketches/Sketches_April.png" alt="April Sketch">
        </div>
      </div>
    </div>
  </main>

  <script>
    const papers = Array.from(document.querySelectorAll('.paper.swipable')).reverse();
    const tocItems = document.querySelectorAll('.toc-item');
    
    let isDragging = false;
    let startX = 0;
    let startY = 0;
    let activePaper = null;

    // Update TOC highlight based on top visible paper
    function updateTOC() {
      const visiblePapers = papers.filter(p => !p.classList.contains('swiped'));
      if (visiblePapers.length === 0) {
        tocItems.forEach(item => {
          item.classList.toggle('active', item.dataset.section === '2026');
        });
        return;
      }
      
      const topPaper = visiblePapers[0];
      const section = topPaper.dataset.section;
      
      tocItems.forEach(item => {
        item.classList.toggle('active', item.dataset.section === section);
      });
    }

    // Get the current top paper (first non-swiped paper)
    function getTopPaper() {
      return papers.find(p => !p.classList.contains('swiped'));
    }

    // Swipe paper away
    function swipePaper(paper) {
      if (!paper) return;
      paper.classList.add('swiped');
      updateTOC();
    }

    // Simple swipe handlers
    function handleStart(e) {
      const paper = getTopPaper();
      if (!paper) return;

      isDragging = true;
      activePaper = paper;
      startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
      startY = e.type.includes('mouse') ? e.clientY : e.touches[0].clientY;
    }

    function handleEnd(e) {
      if (!isDragging || !activePaper) return;
      
      const endX = e.type.includes('mouse') ? e.clientX : e.changedTouches[0].clientX;
      const endY = e.type.includes('mouse') ? e.clientY : e.changedTouches[0].clientY;
      const deltaX = endX - startX;
      const deltaY = endY - startY;
      
      // Check if it's a horizontal swipe (more horizontal than vertical)
      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
        // Swipe detected - fade out and slide away
        const paper = activePaper;
        paper.style.transition = 'transform 0.3s ease-out, opacity 0.3s ease-out';
        paper.style.transform = `translateX(${deltaX > 0 ? 300 : -300}px)`;
        paper.style.opacity = '0';
        
        setTimeout(() => {
          swipePaper(paper);
        }, 300);
      }
      
      isDragging = false;
      activePaper = null;
    }

    // Event listeners
    const paperStack = document.getElementById('paper-stack');
    paperStack.addEventListener('mousedown', handleStart);
    document.addEventListener('mouseup', handleEnd);

    paperStack.addEventListener('touchstart', handleStart, { passive: true });
    document.addEventListener('touchend', handleEnd);

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
        const paper = getTopPaper();
        if (paper) {
          paper.style.transition = 'transform 0.3s ease-out, opacity 0.3s ease-out';
          paper.style.transform = `translateX(${e.key === 'ArrowLeft' ? -300 : 300}px)`;
          paper.style.opacity = '0';
          setTimeout(() => swipePaper(paper), 300);
        }
      }
    });

    // TOC click navigation - go to that section (bring back papers if needed)
    tocItems.forEach((item) => {
      item.addEventListener('click', () => {
        const targetSection = item.dataset.section;
        
        // Find the first paper with this section
        const targetPaperIndex = papers.findIndex(p => p.dataset.section === targetSection);
        
        if (targetPaperIndex === -1) return;
        
        // Reset all papers up to and including the target, swipe papers before it
        papers.forEach((paper, index) => {
          if (index < targetPaperIndex) {
            // Papers before target should be swiped
            paper.classList.add('swiped');
            paper.style.transition = 'transform 0.25s ease-out, opacity 0.2s ease-out';
            paper.style.transform = `translateX(-300px)`;
            paper.style.opacity = '0';
          } else {
            // Papers at or after target should be visible
            paper.classList.remove('swiped');
            paper.style.transition = 'transform 0.25s ease-out, opacity 0.2s ease-out';
            paper.style.transform = '';
            paper.style.opacity = '';
          }
        });
        
        updateTOC();
      });
    });

    // Initialize
    updateTOC();
  </script>
</body>
</html>
