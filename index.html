<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Op. 2025 — The Year of the Snake</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500;1,600&family=David+Libre:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Shadow Overlay -->
  <div class="shadow-overlay">
    <img src="images/Textures/ShadowHorizontal.png" alt="" class="shadow-img">
  </div>

  <!-- Table of Contents -->
  <nav class="toc">
    <div class="toc-content">
      <ul class="toc-list">
        <li class="toc-item active" data-index="0">No. 1. Birthday</li>
        <li class="toc-item" data-index="1">No. 2. Sketches</li>
        <li class="toc-item" data-index="3">No. 3. Dates</li>
        <li class="toc-item" data-index="6">No. 4. Books</li>
        <li class="toc-item" data-index="8">No. 5. Piano</li>
        <li class="toc-item" data-index="11">No. 6. Questions</li>
        <li class="toc-item" data-index="13">No. 7. Lessons</li>
        <li class="toc-item" data-index="15">No. 8. 2026</li>
      </ul>
      <img src="images/Brace.svg" alt="" class="brace">
    </div>
  </nav>

  <!-- Main Container -->
  <main class="main-container">
    <!-- Title - centered above stack -->
    <header class="header">
      <h1 class="title">My <em>2025</em> Wrapped</h1>
      <div class="subtitle-row">
        <p class="subtitle">(The Year of the Snake)</p>
        <p class="author">Zoe 郑</p>
      </div>
    </header>

    <!-- Paper Stack Area -->
    <div class="stack-area">
      <!-- Active draggable stack -->
      <div class="paper-stack" id="paper-stack">
        <div class="paper" data-index="0">
          <img src="images/BirthdayPolaroids.png" alt="Birthday" draggable="false">
        </div>
        <div class="paper" data-index="1">
          <img src="images/sketches/Sketches-PreJ.png" alt="Sketches" draggable="false">
        </div>
        <div class="paper" data-index="2">
          <img src="images/sketches/Sketches-Mar.png" alt="Sketches" draggable="false">
        </div>
        <div class="paper" data-index="3">
          <img src="images/Dates.png" alt="Dates" draggable="false">
        </div>
        <div class="paper" data-index="4">
          <img src="images/sketches/Sketches-April.png" alt="Sketches" draggable="false">
        </div>
        <div class="paper" data-index="5">
          <img src="images/sketches/Sketches-May.png" alt="Sketches" draggable="false">
        </div>
        <div class="paper" data-index="6">
          <img src="images/Books.png" alt="Books" draggable="false">
        </div>
        <div class="paper" data-index="7">
          <img src="images/sketches/Sketches-June.png" alt="Sketches" draggable="false">
        </div>
        <div class="paper" data-index="8">
          <img src="images/piano/GlassEtudeNo.1.png" alt="Piano" draggable="false">
        </div>
        <div class="paper" data-index="9">
          <img src="images/sketches/Sketches-Aug.png" alt="Sketches" draggable="false">
        </div>
        <div class="paper" data-index="10">
          <img src="images/sketches/Sketches-Sep.png" alt="Sketches" draggable="false">
        </div>
        <div class="paper" data-index="11">
          <img src="images/Questions.png" alt="Questions" draggable="false">
        </div>
        <div class="paper" data-index="12">
          <img src="images/sketches/Sketches-Oct.png" alt="Sketches" draggable="false">
        </div>
        <div class="paper" data-index="13">
          <img src="images/Lessons.png" alt="Lessons" draggable="false">
        </div>
        <div class="paper" data-index="14">
          <img src="images/sketches/Sketches-Dec.png" alt="Sketches" draggable="false">
        </div>
        <div class="paper paper-final" data-index="15">
          <img src="images/2026 Symbol.png" alt="2026" draggable="false">
        </div>
      </div>
    </div>
  </main>

  <script>
    const paperStack = document.getElementById('paper-stack');
    const papers = Array.from(document.querySelectorAll('.paper'));
    const tocItems = document.querySelectorAll('.toc-item');
    
    let currentIndex = 0;
    let isDragging = false;
    let startX = 0;
    let currentX = 0;
    let activePaper = null;

    // Section start indices
    const sectionStarts = [0, 1, 3, 6, 8, 11, 13, 15];
    
    // Update TOC highlight based on which section the current index is in
    function updateTOC(index) {
      let activeSection = 0;
      for (let i = sectionStarts.length - 1; i >= 0; i--) {
        if (index >= sectionStarts[i]) {
          activeSection = i;
          break;
        }
      }
      tocItems.forEach((item, i) => {
        item.classList.toggle('active', i === activeSection);
      });
    }

    // Get the current top paper
    function getTopPaper() {
      return papers[currentIndex];
    }

    // Swipe paper - just hide it (disappear)
    function swipePaper() {
      if (currentIndex >= papers.length - 1) return; // Don't swipe the last paper (2026)
      
      const paper = getTopPaper();
      if (!paper) return;

      // Just hide the paper (make it disappear)
      paper.classList.add('hidden');
      
      currentIndex++;
      updateTOC(currentIndex);
    }

    // Bring paper back
    function bringBackPaper() {
      if (currentIndex <= 0) return;
      
      currentIndex--;

      // Show the paper again
      const paper = papers[currentIndex];
      paper.classList.remove('hidden');
      paper.style.transform = '';
      
      updateTOC(currentIndex);
    }

    // Mouse/Touch handlers
    function handleStart(e) {
      // Don't allow dragging the final 2026 paper
      if (currentIndex >= papers.length - 1) return;
      
      const paper = getTopPaper();
      if (!paper || paper.classList.contains('paper-final')) return;

      isDragging = true;
      activePaper = paper;
      startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
      currentX = startX;
      
      paper.style.transition = 'none';
      paper.style.cursor = 'grabbing';
    }

    function handleMove(e) {
      if (!isDragging || !activePaper) return;
      
      currentX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
      const deltaX = currentX - startX;
      
      // Allow dragging left (add rotation effect)
      const rotation = deltaX * 0.03;
      activePaper.style.transform = `translateX(calc(-50% + ${deltaX}px)) rotate(${rotation}deg)`;
    }

    function handleEnd() {
      if (!isDragging || !activePaper) return;
      
      isDragging = false;
      activePaper.style.transition = '';
      activePaper.style.cursor = '';
      
      const deltaX = currentX - startX;
      
      // If dragged far enough left, swipe it
      if (deltaX < -100) {
        swipePaper();
      } else if (deltaX > 100) {
        bringBackPaper();
      } else {
        // Reset position to centered
        const idx = activePaper.dataset.index;
        const rotations = [1, -1.2, 0.8, 3, -0.6, 1.4, -0.9, 0.5, -1.1, 0.7, -0.4, 1.3, -0.8, 1.5, -1, 0.3];
        activePaper.style.transform = `translateX(-50%) rotate(${rotations[idx]}deg)`;
      }
      
      activePaper = null;
    }

    // Event listeners for the stack
    paperStack.addEventListener('mousedown', handleStart);
    document.addEventListener('mousemove', handleMove);
    document.addEventListener('mouseup', handleEnd);

    paperStack.addEventListener('touchstart', handleStart, { passive: true });
    document.addEventListener('touchmove', handleMove, { passive: true });
    document.addEventListener('touchend', handleEnd);

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') {
        swipePaper();
      } else if (e.key === 'ArrowRight') {
        bringBackPaper();
      }
    });

    // TOC click navigation
    tocItems.forEach((item) => {
      item.addEventListener('click', () => {
        const targetIndex = parseInt(item.dataset.index);
        
        // Reset all papers
        papers.forEach((paper, i) => {
          if (i < targetIndex) {
            paper.classList.add('hidden');
          } else {
            paper.classList.remove('hidden');
            paper.style.transform = '';
          }
        });
        
        currentIndex = targetIndex;
        updateTOC(currentIndex);
      });
    });

    // Initialize
    updateTOC(0);
  </script>
</body>
</html>

